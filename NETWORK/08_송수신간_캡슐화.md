# TCP/IP 계층 간 데이터 송수신 과정 (캡슐화 & 비캡슐화)

TCP/IP 모델에서 데이터가 송수신될 때 **캡슐화(Encapsulation)**와 **비캡슐화(Decapsulation)** 과정이 발생합니다.

---

## 📤 1. 송신 측 (캡슐화 과정)
데이터가 애플리케이션에서 네트워크를 통해 전송될 때, **각 계층에서 헤더를 추가하면서 캡슐화**됩니다.

| 계층 | 캡슐화 과정 |
|------|------------------------------------------------|
| **애플리케이션 계층** | - 사용자 데이터 생성 (예: HTTP 요청, 이메일) <br> - **애플리케이션 계층 헤더 추가** |
| **전송 계층** | - 데이터를 **세그먼트(Segment) 또는 데이터그램(Datagram)**으로 변환 <br> - **TCP 또는 UDP 헤더 추가** (포트 번호, 오류 검출 등) |
| **인터넷 계층** | - 데이터를 **패킷(Packet)**으로 변환 <br> - **IP 헤더 추가** (출발지 및 목적지 IP 주소 포함) |
| **네트워크 접근 계층** | - 데이터를 **프레임(Frame)**으로 변환 <br> - **MAC(이더넷) 헤더 및 트레일러 추가** <br> - 비트 스트림으로 변환 후 네트워크로 전송 |

---

## 📥 2. 수신 측 (비캡슐화 과정)
네트워크에서 받은 데이터는 **계층을 거치면서 헤더가 제거되며 원래 데이터로 복원**됩니다.

| 계층 | 비캡슐화 과정 |
|------|------------------------------------------------|
| **네트워크 접근 계층** | - **프레임 수신** <br> - **MAC 헤더 및 트레일러 제거** 후 IP 패킷을 인터넷 계층으로 전달 |
| **인터넷 계층** | - **IP 헤더 제거** 후 전송 계층으로 전달 <br> - 목적지 IP가 현재 장치와 일치하는지 확인 |
| **전송 계층** | - **TCP/UDP 헤더 제거** 후 애플리케이션 계층으로 전달 <br> - TCP의 경우 **데이터 순서 재정렬 및 오류 복구 수행** |
| **애플리케이션 계층** | - 원래의 데이터(예: 웹 페이지, 이메일 등)를 사용자에게 제공 |

---

## 🔑 정리
- **캡슐화(Encapsulation)**: 데이터에 헤더를 추가하며 하위 계층으로 전달 (**송신 과정**)  
- **비캡슐화(Decapsulation)**: 헤더를 제거하며 상위 계층으로 전달 (**수신 과정**)  
- **각 계층은 해당 계층의 프로토콜에 따라 헤더를 추가/제거하여 데이터의 원활한 송수신을 보장**  